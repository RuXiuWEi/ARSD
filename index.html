<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>品牌商后台基础-操作日志管理</title>
    <!-- 引入Element Plus样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
    <!-- 引入Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- 引入Element Plus组件库 -->
    <script src="https://unpkg.com/element-plus/dist/index.full.js"></script>
    <!-- 引入Element Plus图标 -->
    <script src="https://unpkg.com/@element-plus/icons-vue"></script>
    <style>
        * {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
        }
        
        body { 
            margin: 0; 
            padding: 0; 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; 
            background: #e8e8e8;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* 整体容器 */
        .app-container {
            max-width: 90%;
            margin: 0 auto;
            background: #f0f2f5;
            min-height: 100vh;
            position: relative;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* 内容容器 */
        .content-wrapper {
            width: 100%;
            background: #f0f2f5;
        }
        
        /* 顶部用户信息栏 */
        .user-info-bar {
            background: #f5f5f5;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            font-size: 13px;
            color: #333;
            border-bottom: 1px solid #e8e8e8;
        }
        
        .user-info-left {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
        }
        
        .user-info-right {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
        }
        
        .user-info-right .user-info-item:not(:last-child) {
            margin-right: 15px;
        }
        
        .user-info-item {
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            -webkit-transition: background-color 0.3s ease;
            -moz-transition: background-color 0.3s ease;
            -o-transition: background-color 0.3s ease;
            transition: background-color 0.3s ease;
        }
        
        .user-info-item:hover {
            background-color: rgba(0,0,0,0.05);
        }
        
        /* 顶部全局导航栏背景容器 */
        .nav-bg-container {
            background: #1890ff;
            width: 100%;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        /* 导航栏背景全屏扩展 */
        .nav-bg-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: -5.55%;
            right: -5.55%;
            bottom: 0;
            background: #1890ff;
            z-index: -1;
        }
        
        /* 顶部全局导航栏内容 */
        .top-nav {
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }
        
        .nav-left {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
        }
        
        .brand-logo {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
            color: white;
            font-size: 19px;
            font-weight: bold;
            margin-right: 40px;
        }
        
        .brand-logo img {
            width: 32px;
            height: 32px;
            margin-right: 8px;
        }
        
        .main-nav {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
        }
        
        .main-nav a:not(:last-child) {
            margin-right: 30px;
        }
        
        .main-nav-item {
            color: white;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 15px;
            -webkit-transition: background-color 0.3s ease;
            -moz-transition: background-color 0.3s ease;
            -o-transition: background-color 0.3s ease;
            transition: background-color 0.3s ease;
        }
        
        .main-nav-item:hover {
            background-color: #0d7cdd;
        }
        

        
        /* 主体布局 */
        .main-layout {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            min-height: calc(100vh - 100px);
            min-height: -webkit-calc(100vh - 100px);
            min-height: -moz-calc(100vh - 100px);
        }
        
        /* 左侧菜单 */
        .sidebar {
            width: 250px;
            background: white;
            border-right: 1px solid #e8e8e8;
            overflow-y: auto;
        }
        
        .menu-item {
            padding: 10px 16px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .menu-item.level1 {
            background: #fafafa;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        .menu-item.level2 {
            padding-left: 32px;
            color: #666;
            font-size: 14px;
        }
        
        .menu-item.level3 {
            padding-left: 48px;
            color: #888;
            font-size: 14px;
        }
       

        .menu-item.active {
            background: #333;
            color: white;
        }
        
        .menu-item.collapsed {
            color: #999;
        }
        
        .menu-expand-icon {
            float: right;
            margin-top: 2px;
        }
        
        /* 主内容区域 */
        .main-content {
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
            padding: 16px;
            background: #f0f2f5;
        }
        
        .breadcrumb {
            background: white;
            padding: 10px 16px;
            margin-bottom: 16px;
            border-radius: 6px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
            font-size: 14px;
        }
        
        .filter-section, .logs-section { 
            background: white; 
            border-radius: 6px; 
            padding: 16px; 
            margin-bottom: 16px; 
            box-shadow: 0 1px 4px rgba(0,0,0,0.1); 
        }
        .filter-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); 
            gap: 16px; 
            margin-bottom: 16px; 
        }
        .btn-group { 
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex; 
            -webkit-box-pack: center;
            -webkit-justify-content: center;
            -ms-flex-pack: center;
            justify-content: center; 
        }
        
        .btn-group .el-button:not(:last-child) {
            margin-right: 10px;
        }
        .detail-section { 
            margin-bottom: 25px; 
        }
        .detail-section h4 { 
            color: #667eea; 
            margin-bottom: 12px; 
            border-bottom: 1px solid #eee; 
            padding-bottom: 6px; 
            font-size: 16px;
            font-weight: 600;
        }
        .detail-item { 
            display: flex; 
            margin-bottom: 10px; 
            padding: 8px 0; 
            border-bottom: 1px solid #f5f5f5; 
        }
        .detail-label { 
            font-weight: bold; 
            width: 120px; 
            color: #555; 
        }
        .detail-value { 
            flex: 1; 
            color: #333; 
        }
        .change-item { 
            background: #f8f9fa; 
            padding: 10px; 
            border-radius: 5px; 
            margin: 5px 0; 
        }
        .change-before { 
            color: #dc3545; 
        }
        .change-after { 
            color: #28a745; 
        }
        .search-highlight { 
            background-color: #fff3cd; 
            padding: 2px 4px; 
            border-radius: 3px; 
        }
        .log-level-system { 
            color: #e6a23c; 
            font-weight: bold; 
        }
        .log-level-app { 
            color: #409eff; 
            font-weight: bold; 
        }
        
        /* Element Plus 组件样式调整 */
        .el-form-item {
            margin-bottom: 0;
        }
        
        .el-form-item__label {
            font-size: 14px !important;
            line-height: 1.5 !important;
            color: #333 !important;
        }
        
        .el-input__inner, .el-select__inner {
            font-size: 14px !important;
        }
        
        .el-table {
            font-size: 14px !important;
        }
        
        .el-table th {
            font-size: 14px !important;
            font-weight: 600 !important;
        }
        
        .el-button {
            font-size: 14px !important;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="app-container">
            <!-- 顶部用户信息栏 -->
            <div class="user-info-bar">
                <div class="user-info-left">
                    <span class="user-info-item">您好，khcgb2023 ▼</span>
                </div>
                <div class="user-info-right">
                    <span class="user-info-item">商户中心 ▼</span>
                    <span class="user-info-item">系统设置 ▼</span>
                    <span class="user-info-item">网站导航 ▼</span>
                    <span class="user-info-item">📧</span>
                </div>
            </div>
            
            <!-- 顶部全局导航栏 -->
            <div class="nav-bg-container">
                <div class="top-nav">
                    <div class="nav-left">
                        <div class="brand-logo">
                            <img src="https://stati.weixin12315.com/houtai/images/denglu/logoImg.png" alt="米多大数据引擎">
                            米多大数据引擎
                        </div>
                        <nav class="main-nav">
                            <a href="#" class="main-nav-item">首页</a>
                            <a href="#" class="main-nav-item">产品库</a>
                            <a href="#" class="main-nav-item">客户</a>
                            <a href="#" class="main-nav-item">资产</a>
                            <a href="#" class="main-nav-item">公众号</a>
                            <a href="#" class="main-nav-item">订单</a>
                            <a href="#" class="main-nav-item">应用服务 ▼</a>
                        </nav>
                    </div>
                </div>
            </div>
            
            <div class="content-wrapper">
        
        <!-- 主体布局 -->
        <div class="main-layout">
            <!-- 左侧菜单导航 -->
            <div class="sidebar">
                <div class="menu-item level1">
                    <i class="el-icon-setting"></i> 系统配置
                </div>
                <div class="menu-item level2">
                    <i class="el-icon-key"></i> 权限/日志
                </div>
                <div class="menu-item level3">账号管理</div>
                <div class="menu-item level3 active">操作日志</div>
                
                <div class="menu-item level1 collapsed">
                    <i class="el-icon-setting"></i> 通用设置
                    <span class="menu-expand-icon">+</span>
                </div>
                
                <div class="menu-item level1 collapsed">
                    <i class="el-icon-key"></i> 服务授权
                    <span class="menu-expand-icon">+</span>
                </div>
            </div>
            
            <!-- 主内容区域 -->
            <div class="main-content">
                <!-- 面包屑导航 -->
                <div class="breadcrumb">
                    <el-breadcrumb separator=">">
                        <el-breadcrumb-item>系统管理</el-breadcrumb-item>
                        <el-breadcrumb-item>权限/日志</el-breadcrumb-item>
                        <el-breadcrumb-item>操作日志</el-breadcrumb-item>
                    </el-breadcrumb>
                </div>

            <div class="filter-section">
                <h4 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #333;">筛选条件</h4>
                <div class="filter-grid">
                    <el-form-item label="操作时间范围">
                        <el-date-picker
                            v-model="filters.dateRange"
                            type="daterange"
                            range-separator="至"
                            start-placeholder="开始日期"
                            end-placeholder="结束日期"
                            format="YYYY-MM-DD"
                            value-format="YYYY-MM-DD"
                            :default-value="defaultDateRange">
                        </el-date-picker>
                    </el-form-item>
                    
                    <el-form-item label="操作账号">
                        <el-input
                            v-model="filters.operatorAccount"
                            placeholder="输入操作账号"
                            clearable>
                        </el-input>
                    </el-form-item>
                    
                    <el-form-item label="操作人">
                        <el-input
                            v-model="filters.operator"
                            placeholder="输入操作人姓名"
                            clearable>
                        </el-input>
                    </el-form-item>
                    
                    <el-form-item label="操作人IP">
                        <el-input
                            v-model="filters.operatorIP"
                            placeholder="输入IP地址"
                            clearable>
                        </el-input>
                    </el-form-item>
                    
                    <el-form-item label="日志层级">
                        <el-select
                            v-model="filters.logLevel"
                            placeholder="选择日志层级"
                            clearable
                            @change="handleLogLevelChange">
                            <el-option label="全部" value=""></el-option>
                            <el-option label="系统级" value="系统级"></el-option>
                            <el-option label="应用级" value="应用级"></el-option>
                        </el-select>
                    </el-form-item>
                    
                    <el-form-item label="所属应用">
                        <el-select
                            v-model="filters.application"
                            placeholder="选择所属应用"
                            clearable
                            @change="handleApplicationChange">
                            <el-option label="全部" value=""></el-option>
                            <el-option 
                                v-for="app in availableApplications" 
                                :key="app" 
                                :label="app" 
                                :value="app">
                            </el-option>
                        </el-select>
                    </el-form-item>
                    
                    <el-form-item label="操作模块">
                        <el-select
                            v-model="filters.module"
                            placeholder="选择操作模块"
                            clearable>
                            <el-option label="全部" value=""></el-option>
                            <el-option 
                                v-for="module in availableModules" 
                                :key="module" 
                                :label="module" 
                                :value="module">
                            </el-option>
                        </el-select>
                    </el-form-item>
                    
                    <el-form-item label="操作项">
                        <el-input
                            v-model="filters.operationItem"
                            placeholder="输入操作项关键词"
                            clearable>
                        </el-input>
                    </el-form-item>
                    
                    <el-form-item label="执行结果">
                        <el-select
                            v-model="filters.result"
                            placeholder="选择执行结果"
                            clearable>
                            <el-option label="全部" value=""></el-option>
                            <el-option label="成功" value="成功"></el-option>
                            <el-option label="失败" value="失败"></el-option>
                        </el-select>
                    </el-form-item>
                </div>
                
                <div class="btn-group">
                    <el-button type="primary" @click="searchLogs" :icon="Search">查询</el-button>
                    <el-button @click="resetFilters" :icon="Refresh">重置</el-button>
                </div>
            </div>

            <div class="logs-section">
                <h4 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #333;">操作日志列表</h4>
                <el-table
                    :data="displayedLogs"
                    style="width: 100%"
                    :default-sort="{prop: 'time', order: 'descending'}"
                    stripe
                    border
                    max-height="600">
                    <el-table-column prop="time" label="操作时间" sortable width="180"></el-table-column>
                    <el-table-column prop="operatorAccount" label="操作账号" width="120"></el-table-column>
                    <el-table-column prop="operator" label="操作人" width="120">
                        <template #default="scope">
                            <span v-html="highlightSearch(scope.row.operator)"></span>
                        </template>
                    </el-table-column>
                    <el-table-column prop="operatorIP" label="操作人IP" width="130"></el-table-column>
                    <el-table-column prop="logLevel" label="日志层级" width="100">
                        <template #default="scope">
                            <span :class="scope.row.logLevel === '系统级' ? 'log-level-system' : 'log-level-app'">
                                {{ scope.row.logLevel }}
                            </span>
                        </template>
                    </el-table-column>
                    <el-table-column prop="application" label="所属应用" width="150"></el-table-column>
                    <el-table-column prop="module" label="操作模块" width="150"></el-table-column>
                    <el-table-column prop="path" label="具体路径" width="200"></el-table-column>
                    <el-table-column prop="operationItem" label="操作项" width="150">
                        <template #default="scope">
                            <span v-html="highlightSearch(scope.row.operationItem)"></span>
                        </template>
                    </el-table-column>
                    <el-table-column prop="result" label="执行状态" width="100">
                        <template #default="scope">
                            <el-tag :type="scope.row.result === '成功' ? 'success' : 'danger'">
                                {{ scope.row.result }}
                            </el-tag>
                        </template>
                    </el-table-column>
                    <el-table-column label="操作" width="100" fixed="right">
                        <template #default="scope">
                            <el-button
                                size="small"
                                type="primary"
                                @click="showDetail(scope.row)">
                                详情
                            </el-button>
                        </template>
                    </el-table-column>
                </el-table>
                
                <div style="margin-top: 20px; text-align: center;">
                    <el-pagination
                        v-model:current-page="currentPage"
                        v-model:page-size="pageSize"
                        :page-sizes="[10, 20, 50, 100]"
                        :total="displayedLogs.length"
                        layout="total, sizes, prev, pager, next, jumper"
                        @size-change="handleSizeChange"
                        @current-change="handleCurrentChange">
                    </el-pagination>
                </div>
                </div>
        </div>
        </div>
        </div>

        <!-- 操作详情抽屉 -->
        <el-drawer
            v-model="drawerVisible"
            title="操作详情"
            direction="rtl"
            size="700px">
            <div class="drawer-content">
                <div class="detail-section">
                    <h4>基本信息</h4>
                    <div class="detail-item">
                        <span class="detail-label">操作ID:</span>
                        <span class="detail-value">{{ currentLog.id }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">操作时间:</span>
                        <span class="detail-value">{{ currentLog.time }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">操作账号:</span>
                        <span class="detail-value">{{ currentLog.operatorAccount }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">操作人:</span>
                        <span class="detail-value">{{ currentLog.operator }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">操作人IP:</span>
                        <span class="detail-value">{{ currentLog.operatorIP }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">日志层级:</span>
                        <span class="detail-value">
                            <span :class="currentLog.logLevel === '系统级' ? 'log-level-system' : 'log-level-app'">
                                {{ currentLog.logLevel }}
                            </span>
                        </span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">所属应用:</span>
                        <span class="detail-value">{{ currentLog.application }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">操作模块:</span>
                        <span class="detail-value">{{ currentLog.module }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">具体路径:</span>
                        <span class="detail-value">{{ currentLog.path }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">操作项:</span>
                        <span class="detail-value">{{ currentLog.operationItem }}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">执行状态:</span>
                        <span class="detail-value">
                            <el-tag :type="currentLog.result === '成功' ? 'success' : 'danger'">
                                {{ currentLog.result }}
                            </el-tag>
                        </span>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h4>操作详情</h4>
                    <div v-if="currentLog.details">
                        <!-- 新增类操作详情 -->
                        <div v-if="currentLog.operationItem.includes('新增') || currentLog.operationItem.includes('上传')" class="detail-item">
                            <span class="detail-label">{{ currentLog.operationItem }}详情:</span>
                            <div class="detail-value">
                                <div v-for="(value, key) in currentLog.details" :key="key" v-if="key !== 'operationId'">
                                    {{ getFieldLabel(key) }}: {{ value }}
                                </div>
                            </div>
                        </div>
                        
                        <!-- 修改类操作详情 -->
                        <div v-else-if="currentLog.operationItem.includes('修改') || currentLog.operationItem.includes('编辑')" class="detail-item">
                            <span class="detail-label">{{ currentLog.operationItem }}详情:</span>
                            <div class="detail-value">
                                <div v-for="change in currentLog.details.changes" :key="change.field" class="change-item">
                                    <span class="change-before">{{ getFieldLabel(change.field) }}: {{ change.before }}</span>
                                    <span> → </span>
                                    <span class="change-after">{{ change.after }}</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 删除类操作详情 -->
                        <div v-else-if="currentLog.operationItem.includes('删除')" class="detail-item">
                            <span class="detail-label">{{ currentLog.operationItem }}详情:</span>
                            <div class="detail-value">
                                <div v-for="(value, key) in getDeletedInfo(currentLog.details)" :key="key">
                                    {{ getFieldLabel(key) }}: {{ value }}
                                </div>
                            </div>
                        </div>
                        
                        <!-- 导入类操作详情 -->
                        <div v-else-if="currentLog.operationItem.includes('导入')" class="detail-item">
                            <span class="detail-label">{{ currentLog.operationItem }}详情:</span>
                            <div class="detail-value">
                                <div class="detail-item">
                                    <span class="detail-label">导入文件:</span>
                                    <span class="detail-value">
                                        <el-link :href="currentLog.details.importFile" target="_blank" type="primary">
                                            {{ currentLog.details.importFile }}
                                        </el-link>
                                    </span>
                                </div>
                                <div v-if="currentLog.details.importedCount" class="detail-item">
                                    <span class="detail-label">导入数量:</span>
                                    <span class="detail-value">{{ currentLog.details.importedCount }}</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 导出类操作详情 -->
                        <div v-else-if="currentLog.operationItem.includes('导出')" class="detail-item">
                            <span class="detail-label">{{ currentLog.operationItem }}详情:</span>
                            <div class="detail-value">
                                <div class="detail-item">
                                    <span class="detail-label">导出文件:</span>
                                    <span class="detail-value">
                                        <el-link :href="currentLog.details.exportFile" target="_blank" type="primary">
                                            {{ currentLog.details.exportFile }}
                                        </el-link>
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 还原类操作详情 -->
                        <div v-else-if="currentLog.operationItem.includes('还原')" class="detail-item">
                            <span class="detail-label">{{ currentLog.operationItem }}详情:</span>
                            <div class="detail-value">
                                <div class="detail-item">
                                    <span class="detail-label">操作ID:</span>
                                    <span class="detail-value">{{ currentLog.details.operationId }}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">说明:</span>
                                    <span class="detail-value">可通过删除日志查看详情，避免累赘</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 彻底删除类操作详情 -->
                        <div v-else-if="currentLog.operationItem.includes('彻底删除')" class="detail-item">
                            <span class="detail-label">{{ currentLog.operationItem }}详情:</span>
                            <div class="detail-value">
                                <div class="detail-item">
                                    <span class="detail-label">操作ID:</span>
                                    <span class="detail-value">{{ currentLog.details.operationId }}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">说明:</span>
                                    <span class="detail-value">可通过删除日志查看详情，避免累赘</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 默认情况 -->
                        <div v-else class="detail-item">
                            <span class="detail-label">{{ currentLog.operationItem }}详情:</span>
                            <div class="detail-value">
                                <div v-for="(value, key) in currentLog.details" :key="key" v-if="key !== 'operationId'">
                                    {{ getFieldLabel(key) }}: {{ value }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </el-drawer>
    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;
        const { Search, Refresh } = ElementPlusIconsVue;

        createApp({
            setup() {
                const mockLogs = ref([
                    // 产品库-产品管理
                    {
                        id: "275256",
                        time: "2024-01-05 14:30:25",
                        operatorAccount: "abcde1234",
                        operator: "张三",
                        operatorIP: "192.168.1.100",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品管理",
                        operationItem: "上传产品",
                        result: "成功",
                        details: {
                            operationId: "275256",
                            productName: "百威啤酒",
                            productType: "实物商品",
                            price: "15.00",
                            stock: "1000",
                            brand: "百威",
                            category: "啤酒"
                        }
                    },
                    {
                        id: "277649",
                        time: "2024-01-05 15:20:10",
                        operatorAccount: "fghij5678",
                        operator: "李四",
                        operatorIP: "192.168.1.101",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品管理",
                        operationItem: "编辑产品",
                        result: "成功",
                        details: {
                            operationId: "277649",
                            changes: [
                                { field: "价格", before: "118", after: "128" },
                                { field: "总库存", before: "100", after: "500" }
                            ]
                        }
                    },
                    {
                        id: "277650",
                        time: "2024-01-05 16:15:30",
                        operatorAccount: "abcde1234",
                        operator: "张三",
                        operatorIP: "192.168.1.100",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品管理",
                        operationItem: "删除产品",
                        result: "成功",
                        details: {
                            operationId: "277650",
                            deletedProduct: {
                                productName: "过期产品",
                                productType: "实物商品",
                                price: "50.00",
                                brand: "过期品牌",
                                category: "过期分类"
                            }
                        }
                    },
                    {
                        id: "277651",
                        time: "2024-01-05 17:00:45",
                        operatorAccount: "klmno9012",
                        operator: "王五",
                        operatorIP: "192.168.1.102",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品管理",
                        operationItem: "批量导入产品",
                        result: "成功",
                        details: {
                            operationId: "277651",
                            importFile: "https://example.com/files/products_20240105.xlsx",
                            importedCount: "150"
                        }
                    },
                    {
                        id: "277652",
                        time: "2024-01-05 18:30:20",
                        operatorAccount: "pqrst3456",
                        operator: "赵六",
                        operatorIP: "192.168.1.103",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品管理",
                        operationItem: "导出产品",
                        result: "成功",
                        details: {
                            operationId: "277652",
                            exportFile: "https://example.com/files/products_export_20240105.xlsx"
                        }
                    },
                    {
                        id: "277653",
                        time: "2024-01-05 19:15:10",
                        operatorAccount: "abcde1234",
                        operator: "张三",
                        operatorIP: "192.168.1.100",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品管理",
                        operationItem: "还原产品",
                        result: "成功",
                        details: {
                            operationId: "277653"
                        }
                    },
                    {
                        id: "277654",
                        time: "2024-01-05 20:00:00",
                        operatorAccount: "fghij5678",
                        operator: "李四",
                        operatorIP: "192.168.1.101",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品管理",
                        operationItem: "彻底删除产品",
                        result: "成功",
                        details: {
                            operationId: "277654"
                        }
                    },
                    
                    // 产品库-产品分类
                    {
                        id: "277655",
                        time: "2024-01-06 09:00:00",
                        operatorAccount: "klmno9012",
                        operator: "王五",
                        operatorIP: "192.168.1.102",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品分类",
                        operationItem: "新增一级分类",
                        result: "成功",
                        details: {
                            operationId: "277655",
                            categoryName: "酒类",
                            categoryLevel: "一级分类"
                        }
                    },
                    {
                        id: "277656",
                        time: "2024-01-06 10:30:00",
                        operatorAccount: "pqrst3456",
                        operator: "赵六",
                        operatorIP: "192.168.1.103",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品分类",
                        operationItem: "新增二级分类",
                        result: "成功",
                        details: {
                            operationId: "277656",
                            categoryName: "白酒",
                            parentCategory: "酒类",
                            categoryLevel: "二级分类"
                        }
                    },
                    {
                        id: "277657",
                        time: "2024-01-06 11:15:00",
                        operatorAccount: "abcde1234",
                        operator: "张三",
                        operatorIP: "192.168.1.100",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品分类",
                        operationItem: "修改分类",
                        result: "成功",
                        details: {
                            operationId: "277657",
                            changes: [
                                { field: "分类名称", before: "白酒", after: "酒" }
                            ]
                        }
                    },
                    {
                        id: "277658",
                        time: "2024-01-06 14:20:00",
                        operatorAccount: "fghij5678",
                        operator: "李四",
                        operatorIP: "192.168.1.101",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-产品库-产品分类",
                        operationItem: "删除分类",
                        result: "成功",
                        details: {
                            operationId: "277658",
                            deletedCategory: {
                                categoryName: "白酒",
                                parentCategory: "酒类",
                                categoryLevel: "二级分类"
                            }
                        }
                    },
                    
                    // 产品库-礼品库-自有礼品
                    {
                        id: "277659",
                        time: "2024-01-06 15:45:00",
                        operatorAccount: "klmno9012",
                        operator: "王五",
                        operatorIP: "192.168.1.102",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-礼品库-自有礼品",
                        operationItem: "上传礼品",
                        result: "成功",
                        details: {
                            operationId: "277659",
                            giftName: "百威礼品",
                            giftType: "实物礼品",
                            marketValue: "100元",
                            exchangeMethod: "免费兑换",
                            brand: "百威"
                        }
                    },
                    {
                        id: "277660",
                        time: "2024-01-06 16:30:00",
                        operatorAccount: "pqrst3456",
                        operator: "赵六",
                        operatorIP: "192.168.1.103",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-礼品库-自有礼品",
                        operationItem: "编辑礼品",
                        result: "成功",
                        details: {
                            operationId: "277660",
                            changes: [
                                { field: "礼品名称", before: "百威礼品", after: "巧克力礼品" },
                                { field: "市面价值", before: "100元", after: "200元" }
                            ]
                        }
                    },
                    {
                        id: "277661",
                        time: "2024-01-06 17:15:00",
                        operatorAccount: "abcde1234",
                        operator: "张三",
                        operatorIP: "192.168.1.100",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-礼品库-自有礼品",
                        operationItem: "删除礼品",
                        result: "成功",
                        details: {
                            operationId: "277661",
                            deletedGift: {
                                giftName: "百威礼品",
                                giftType: "实物礼品",
                                marketValue: "100元",
                                exchangeMethod: "免费兑换",
                                brand: "百威"
                            }
                        }
                    },
                    {
                        id: "277662",
                        time: "2024-01-06 18:00:00",
                        operatorAccount: "fghij5678",
                        operator: "李四",
                        operatorIP: "192.168.1.101",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-礼品库-自有礼品",
                        operationItem: "导出礼品",
                        result: "成功",
                        details: {
                            operationId: "277662",
                            exportFile: "https://example.com/files/gifts_export_20240106.xlsx"
                        }
                    },
                    
                    // 产品库-礼品库-分组管理
                    {
                        id: "277663",
                        time: "2024-01-07 09:30:00",
                        operatorAccount: "klmno9012",
                        operator: "王五",
                        operatorIP: "192.168.1.102",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-礼品库-分组管理",
                        operationItem: "编辑分组",
                        result: "成功",
                        details: {
                            operationId: "277663",
                            changes: [
                                { field: "分组名称", before: "集齐换礼", after: "集齐有礼" }
                            ]
                        }
                    },
                    {
                        id: "277664",
                        time: "2024-01-07 10:15:00",
                        operatorAccount: "pqrst3456",
                        operator: "赵六",
                        operatorIP: "192.168.1.103",
                        logLevel: "系统级",
                        application: "品牌商后台基础",
                        module: "产品库",
                        path: "产品库-礼品库-分组管理",
                        operationItem: "删除分组",
                        result: "成功",
                        details: {
                            operationId: "277664",
                            deletedGroup: {
                                groupName: "集齐有礼",
                                groupType: "礼品分组",
                                memberCount: "50"
                            }
                        }
                    }
                ]);

                const filters = ref({
                    dateRange: [],
                    operatorAccount: '',
                    operator: '',
                    operatorIP: '',
                    logLevel: '',
                    application: '',
                    module: '',
                    operationItem: '',
                    result: ''
                });

                const currentPage = ref(1);
                const pageSize = ref(20);
                const drawerVisible = ref(false);
                const currentLog = ref({});
                const displayedLogs = ref([]); // 新增：用于存储筛选后显示的日志

                const defaultDateRange = [
                    new Date('2024-01-01'),
                    new Date('2024-01-07')
                ];

                // 应用和模块的联动数据
                const applicationModuleMap = {
                    "品牌商后台基础": ["产品库", "客户管理", "营销管理", "系统设置"],
                    "微商城": ["商品管理", "订单管理", "用户管理"],
                    "小程序": ["活动管理", "积分管理", "礼品兑换"]
                };

                const availableApplications = computed(() => {
                    if (filters.value.logLevel === '系统级') {
                        return ["品牌商后台基础"];
                    } else if (filters.value.logLevel === '应用级') {
                        return ["微商城", "小程序"];
                    } else {
                        return Object.keys(applicationModuleMap);
                    }
                });

                const availableModules = computed(() => {
                    if (filters.value.application && applicationModuleMap[filters.value.application]) {
                        return applicationModuleMap[filters.value.application];
                    }
                    return [];
                });



                const handleLogLevelChange = () => {
                    filters.value.application = '';
                    filters.value.module = '';
                };

                const handleApplicationChange = () => {
                    filters.value.module = '';
                };

                const searchLogs = () => {
                    // 执行筛选逻辑
                    displayedLogs.value = mockLogs.value.filter(log => {
                        const logDate = new Date(log.time.split(' ')[0]);
                        
                        return (
                            (!filters.value.dateRange || filters.value.dateRange.length === 0 || 
                             (logDate >= new Date(filters.value.dateRange[0]) && 
                              logDate <= new Date(filters.value.dateRange[1]))) &&
                            (!filters.value.operatorAccount || log.operatorAccount.includes(filters.value.operatorAccount)) &&
                            (!filters.value.operator || log.operator.includes(filters.value.operator)) &&
                            (!filters.value.operatorIP || log.operatorIP.includes(filters.value.operatorIP)) &&
                            (!filters.value.logLevel || log.logLevel === filters.value.logLevel) &&
                            (!filters.value.application || log.application === filters.value.application) &&
                            (!filters.value.module || log.module === filters.value.module) &&
                            (!filters.value.operationItem || log.operationItem.includes(filters.value.operationItem)) &&
                            (!filters.value.result || log.result === filters.value.result)
                        );
                    });
                    currentPage.value = 1;
                };

                const resetFilters = () => {
                    filters.value = {
                        dateRange: [],
                        operatorAccount: '',
                        operator: '',
                        operatorIP: '',
                        logLevel: '',
                        application: '',
                        module: '',
                        operationItem: '',
                        result: ''
                    };
                    displayedLogs.value = [...mockLogs.value]; // 重置时显示所有日志
                    currentPage.value = 1;
                };

                const showDetail = (log) => {
                    currentLog.value = log;
                    drawerVisible.value = true;
                };

                const handleSizeChange = (val) => {
                    pageSize.value = val;
                    currentPage.value = 1;
                };

                const handleCurrentChange = (val) => {
                    currentPage.value = val;
                };

                const highlightSearch = (text) => {
                    const searchTerm = filters.value.operator || filters.value.operationItem;
                    if (!searchTerm) return text;
                    const regex = new RegExp(`(${searchTerm})`, 'gi');
                    return text.replace(regex, '<span class="search-highlight">$1</span>');
                };

                // 获取字段的中文标签
                const getFieldLabel = (key) => {
                    const fieldLabels = {
                        'productName': '产品名称',
                        'productType': '产品类型',
                        'price': '价格',
                        'stock': '库存',
                        'brand': '品牌',
                        'category': '分类',
                        'categoryName': '分类名称',
                        'categoryLevel': '分类级别',
                        'parentCategory': '所属一级分类',
                        'giftName': '礼品名称',
                        'giftType': '礼品类型',
                        'marketValue': '市面价值',
                        'exchangeMethod': '兑换方式',
                        'groupName': '分组名称',
                        'groupType': '分组类型',
                        'memberCount': '成员数量'
                    };
                    return fieldLabels[key] || key;
                };

                // 获取删除信息
                const getDeletedInfo = (details) => {
                    if (details.deletedProduct) return details.deletedProduct;
                    if (details.deletedCategory) return details.deletedCategory;
                    if (details.deletedGift) return details.deletedGift;
                    if (details.deletedGroup) return details.deletedGroup;
                    return {};
                };

                // 生成操作账号（前5位小写字母+后4位数字）
                const generateOperatorAccount = () => {
                    const letters = 'abcdefghijklmnopqrstuvwxyz';
                    const numbers = '0123456789';
                    let account = '';
                    
                    // 生成前5位小写字母
                    for (let i = 0; i < 5; i++) {
                        account += letters[Math.floor(Math.random() * letters.length)];
                    }
                    
                    // 生成后4位数字
                    for (let i = 0; i < 4; i++) {
                        account += numbers[Math.floor(Math.random() * numbers.length)];
                    }
                    
                    return account;
                };

                onMounted(() => {
                    // 设置默认时间范围
                    filters.value.dateRange = ['2024-01-01', '2024-01-07'];
                    // 初始化显示所有日志
                    displayedLogs.value = [...mockLogs.value];
                });

                return {
                    mockLogs,
                    filters,
                    currentPage,
                    pageSize,
                    drawerVisible,
                    currentLog,
                    defaultDateRange,
                    availableApplications,
                    availableModules,
                    displayedLogs,
                    handleLogLevelChange,
                    handleApplicationChange,
                    searchLogs,
                    resetFilters,
                    showDetail,
                    handleSizeChange,
                    handleCurrentChange,
                    highlightSearch,
                    getFieldLabel,
                    getDeletedInfo,
                    generateOperatorAccount,
                    Search,
                    Refresh
                };
            }
        }).use(ElementPlus).mount('#app');
    </script>
</body>
</html>
